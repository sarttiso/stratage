<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="License" href="../license.html" /><link rel="prev" title="stratage" href="modules.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>stratage package - stratage 1.1.0.post1.dev1+gc5f3bc7 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style>
  
  <script defer src="https://umami.ts-ht.com/script.js" data-website-id="0775ec1a-107e-4c73-ab7e-08325a4a5fac"></script>
</head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">stratage 1.1.0.post1.dev1+gc5f3bc7 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">stratage 1.1.0.post1.dev1+gc5f3bc7 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../toy-example.html">Toy Example</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="modules.html">Module Reference</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Module Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">stratage package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/api/stratage.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="stratage-package">
<h1>stratage package<a class="headerlink" href="#stratage-package" title="Link to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-stratage.geochron">
<span id="stratage-geochron-module"></span><h2>stratage.geochron module<a class="headerlink" href="#module-stratage.geochron" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="stratage.geochron.Geochron">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stratage.geochron.</span></span><span class="sig-name descname"><span class="pre">Geochron</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/geochron.html#Geochron"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.geochron.Geochron" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.12/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class for handling geochronologic constraints in stratigraphic sections.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h</strong> (<em>array-like</em>) – List of stratigraphic heights at which temporal constraints are measured. The coordinate increases up section.</p></li>
<li><p><strong>rv</strong> (<em>array-like</em>) – List of random variables representing the temporal constraints at each height. The members of this list must be objects similar to stats.dist objects with the following methods: pdf, ppf (inverse of cdf).</p></li>
<li><p><strong>nt</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – Number of points for computing numerical pdfs from constraints. Defaults to 500.</p></li>
<li><p><strong>ndt</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – Number of points for computing numerical time increment pdfs. Defaults to 100. This value should be smaller than nt to avoid noisiness in the time increment pdfs.</p></li>
<li><p><strong>prob_threshold</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – Probability threshold for determining the temporal range over which to grid. Defaults to 1e-4.</p></li>
<li><p><strong>neighbors</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – Number of neighbors for pairing constraints. Defaults to ‘all’. Valid options are ‘all’ or integers up to n_constraints-1. All pairs are considered in the ‘all’ method. For integer values n, only n neighboring pairs are considered.</p></li>
<li><p><strong>n_jobs</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – Number of jobs to run in parallel for computing time increment pdfs. Defaults to 1</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stratage.geochron.Geochron.h">
<span class="sig-name descname"><span class="pre">h</span></span><a class="headerlink" href="#stratage.geochron.Geochron.h" title="Link to this definition">¶</a></dt>
<dd><p>Sorted list of stratigraphic heights.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#list" title="(in Python v3.12)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stratage.geochron.Geochron.rv">
<span class="sig-name descname"><span class="pre">rv</span></span><a class="headerlink" href="#stratage.geochron.Geochron.rv" title="Link to this definition">¶</a></dt>
<dd><p>Sorted list of random variables representing the temporal constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#list" title="(in Python v3.12)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stratage.geochron.Geochron.n_constraints">
<span class="sig-name descname"><span class="pre">n_constraints</span></span><a class="headerlink" href="#stratage.geochron.Geochron.n_constraints" title="Link to this definition">¶</a></dt>
<dd><p>Number of constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stratage.geochron.Geochron.n_pairs">
<span class="sig-name descname"><span class="pre">n_pairs</span></span><a class="headerlink" href="#stratage.geochron.Geochron.n_pairs" title="Link to this definition">¶</a></dt>
<dd><p>Number of pairs of constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stratage.geochron.Geochron.nt">
<span class="sig-name descname"><span class="pre">nt</span></span><a class="headerlink" href="#stratage.geochron.Geochron.nt" title="Link to this definition">¶</a></dt>
<dd><p>Number of points for computing numerical pdfs from constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stratage.geochron.Geochron.ndt">
<span class="sig-name descname"><span class="pre">ndt</span></span><a class="headerlink" href="#stratage.geochron.Geochron.ndt" title="Link to this definition">¶</a></dt>
<dd><p>Number of points for computing numerical time increment pdfs.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stratage.geochron.Geochron.lower_idx">
<span class="sig-name descname"><span class="pre">lower_idx</span></span><a class="headerlink" href="#stratage.geochron.Geochron.lower_idx" title="Link to this definition">¶</a></dt>
<dd><p>List of indices into h and rv for the lower constraint in each pair.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#list" title="(in Python v3.12)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">upper_idx</span> <span class="pre">list</span></span></dt>
<dd><p>List of indices into h and rv for the upper constraint in each pair.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stratage.geochron.Geochron.model_weights">
<span class="sig-name descname"><span class="pre">model_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/geochron.html#Geochron.model_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.geochron.Geochron.model_weights" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the weights for units and contacts based on their bounding by
geochron constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>units</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – Bottom and top heights of units in section. 2d array (nx2) of bottom and top heights for each of n units</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>alpha</strong> (<em>numpy.ndarray</em>) – 2D array (NxL) of weights for each of N units and L pairs of geochron constraints.</p></li>
<li><p><strong>beta</strong> (<em>numpy.ndarray</em>) – 2D array (MxL) of weights for each of M contacts and L pairs of geochron constraints.</p></li>
</ul>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#AssertionError" title="(in Python v3.12)"><strong>AssertionError</strong></a> – If any rows in alpha or beta are entirely zero, indicating unconstrained model parameters.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Run after <code class="xref py py-func docutils literal notranslate"><span class="pre">stratagemc.trim_units()</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stratage.geochron.Geochron.plot_constraints">
<span class="sig-name descname"><span class="pre">plot_constraints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotstyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fillstyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/geochron.html#Geochron.plot_constraints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.geochron.Geochron.plot_constraints" title="Link to this definition">¶</a></dt>
<dd><p>Plot the geochronologic constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="(in Matplotlib v3.10.3)"><em>matplotlib.axes.Axes</em></a>) – The axes on which to plot the constraints. If None, a new figure is created.</p></li>
<li><p><strong>tol</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The number of orders of magnitude below the maximum pdf value to plot.</p></li>
<li><p><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – The scale factor for the pdfs.</p></li>
<li><p><strong>plotstyle</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>, </em><em>optional</em>) – Additional keyword arguments passed to the matplotlib plot function for visualizing constraint pdfs, defaults to None. If None, the default plot style is used.</p></li>
<li><p><strong>fillstyle</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>, </em><em>optional</em>) – Additional keyword arguments passed to the matplotlib fill_between function for visualizing constraint pdfs, defaults to None. If None, the default fill style is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ax</strong> (<em>matplotlib.axes.Axes</em>) – The axes on which the constraints are plotted.</p></li>
<li><p><strong>h</strong> (<em>list</em>) – The handles for the plotted constraints. Each element of the list is a list of handles for the fill and line plots for a single constraint.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stratage.geochron.Geochron.plot_increment_pdfs">
<span class="sig-name descname"><span class="pre">plot_increment_pdfs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/geochron.html#Geochron.plot_increment_pdfs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.geochron.Geochron.plot_increment_pdfs" title="Link to this definition">¶</a></dt>
<dd><p>Plot the time increment pdfs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="(in Matplotlib v3.10.3)"><em>matplotlib.axes.Axes</em></a><em>, </em><em>optional</em>) – The axes on which to plot the increment pdfs. Defaults to None. If None, a new figure is created.</p></li>
<li><p><strong>tol</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – The number of orders of magnitude below the maximum pdf value to plot. Defaults to 3.</p></li>
<li><p><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – The scale factor for the pdfs. Defaults to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ax</strong> (<em>matplotlib.axes.Axes</em>) – The axes on which the increment pdfs are plotted.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stratage.geochron.Geochron.straddling">
<span class="sig-name descname"><span class="pre">straddling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">height</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/geochron.html#Geochron.straddling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.geochron.Geochron.straddling" title="Link to this definition">¶</a></dt>
<dd><p>Returns the indices of pairs of constraints that straddle a given height.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>height</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – The height in section.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>idx</strong> (<em>numpy.ndarray</em>) – The indices (into self.lower_idx, self.upper_idx) that straddle the given height.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-stratage.stratage">
<span id="stratage-stratage-module"></span><h2>stratage.stratage module<a class="headerlink" href="#module-stratage.stratage" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="stratage.stratage.AgeModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stratage.stratage.</span></span><span class="sig-name descname"><span class="pre">AgeModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geochron</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sed_rates_prior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hiatuses_prior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#AgeModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.stratage.AgeModel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.12/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Age model object for Bayesian inference of sedimentation rates and hiatuses.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="stratage.stratage.AgeModel.units">
<span class="sig-name descname"><span class="pre">units</span></span><a class="headerlink" href="#stratage.stratage.AgeModel.units" title="Link to this definition">¶</a></dt>
<dd><p>nx2 array of unit bottom and top heights for n units.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stratage.stratage.AgeModel.geochron">
<span class="sig-name descname"><span class="pre">geochron</span></span><a class="headerlink" href="#stratage.stratage.AgeModel.geochron" title="Link to this definition">¶</a></dt>
<dd><p>Geochron object containing geochron constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#stratage.geochron.Geochron" title="stratage.geochron.Geochron">geochron.Geochron</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stratage.stratage.AgeModel.sed_rates_prior">
<span class="sig-name descname"><span class="pre">sed_rates_prior</span></span><a class="headerlink" href="#stratage.stratage.AgeModel.sed_rates_prior" title="Link to this definition">¶</a></dt>
<dd><p>Prior distribution for sedimentation rates. Must be valid as dist argument to pymc.CustomDist(dist=dist). Signature is sed_rate_prior(size=size).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>function</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stratage.stratage.AgeModel.hiatuses_prior">
<span class="sig-name descname"><span class="pre">hiatuses_prior</span></span><a class="headerlink" href="#stratage.stratage.AgeModel.hiatuses_prior" title="Link to this definition">¶</a></dt>
<dd><p>Prior distribution for hiatuses. Must be valid as dist argument to pymc.CustomDist(dist=dist). Signature is hiatus_prior(size=size).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>function</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stratage.stratage.AgeModel.n_units">
<span class="sig-name descname"><span class="pre">n_units</span></span><a class="headerlink" href="#stratage.stratage.AgeModel.n_units" title="Link to this definition">¶</a></dt>
<dd><p>Number of units.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stratage.stratage.AgeModel.n_contacts">
<span class="sig-name descname"><span class="pre">n_contacts</span></span><a class="headerlink" href="#stratage.stratage.AgeModel.n_contacts" title="Link to this definition">¶</a></dt>
<dd><p>Number of contacts.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stratage.stratage.AgeModel.units_trim">
<span class="sig-name descname"><span class="pre">units_trim</span></span><a class="headerlink" href="#stratage.stratage.AgeModel.units_trim" title="Link to this definition">¶</a></dt>
<dd><p>Trimmed unit heights after adjusting for the top and bottom units.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stratage.stratage.AgeModel.sed_rates_ls">
<span class="sig-name descname"><span class="pre">sed_rates_ls</span></span><a class="headerlink" href="#stratage.stratage.AgeModel.sed_rates_ls" title="Link to this definition">¶</a></dt>
<dd><p>Sedimentation rates from least squares model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stratage.stratage.AgeModel.hiatuses_ls">
<span class="sig-name descname"><span class="pre">hiatuses_ls</span></span><a class="headerlink" href="#stratage.stratage.AgeModel.hiatuses_ls" title="Link to this definition">¶</a></dt>
<dd><p>Hiatuses from least squares model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stratage.stratage.AgeModel.model">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#stratage.stratage.AgeModel.model" title="Link to this definition">¶</a></dt>
<dd><p>PyMC model object for Bayesian inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pymc.Model</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stratage.stratage.AgeModel.vars_list">
<span class="sig-name descname"><span class="pre">vars_list</span></span><a class="headerlink" href="#stratage.stratage.AgeModel.vars_list" title="Link to this definition">¶</a></dt>
<dd><p>List of variables in the pymc.model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#list" title="(in Python v3.12)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stratage.stratage.AgeModel.fit_absolute_age">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fit_absolute_age</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ii</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sed_rates_post</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hiatuses_post</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units_trim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geochron</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#AgeModel.fit_absolute_age"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.stratage.AgeModel.fit_absolute_age" title="Link to this definition">¶</a></dt>
<dd><p>Fit the age model for the ii-th sample of the posterior.</p>
<p>Static method to work with joblib.Parallel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ii</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Index of the posterior sample.</p></li>
<li><p><strong>sed_rates_post</strong> (<em>ndarray</em>) – Sedimentation rates for each unit, ii-th posterior sample.</p></li>
<li><p><strong>hiatuses_post</strong> (<em>ndarray</em>) – Hiatuses between units, ii-th posterior sample.</p></li>
<li><p><strong>units_trim</strong> (<em>ndarray</em>) – Trimmed unit heights after adjusting for the top and bottom units.</p></li>
<li><p><strong>geochron</strong> (<a class="reference internal" href="#stratage.geochron.Geochron" title="stratage.geochron.Geochron"><em>Geochron</em></a>) – Geochron object containing geochron constraints.</p></li>
<li><p><strong>h</strong> (<em>arraylike</em>) – Heights at which to evaluate the age model.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Method for optimization in fit_floating_model(). ‘max’ for maximum likelihood, ‘random’ for random sampling of alignment likelihood.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ndarray</strong> – Ages at the given height(s).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stratage.stratage.AgeModel.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">draws</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#AgeModel.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.stratage.AgeModel.sample" title="Link to this definition">¶</a></dt>
<dd><p>Sample posterior distribution of sedimentation rates and hiatus durations.</p>
<p>The output of this function must be transformed to age models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>draws</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – Number of posterior draws. Defaults to 1000.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>arviz.InferenceData</strong> – ArviZ InferenceData object containing the MCMC trace.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stratage.stratage.AgeModel.sample_prior">
<span class="sig-name descname"><span class="pre">sample_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">draws</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#AgeModel.sample_prior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.stratage.AgeModel.sample_prior" title="Link to this definition">¶</a></dt>
<dd><p>Sample prior predictive distribution of age models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>draws</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – Number of prior predictive draws. Defaults to 100.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>list</strong> – List of prior predictive samples of times; each element is a nx2 array of unit bottom and top times for n units.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stratage.stratage.AgeModel.trace2ages">
<span class="sig-name descname"><span class="pre">trace2ages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_posterior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'random'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#AgeModel.trace2ages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.stratage.AgeModel.trace2ages" title="Link to this definition">¶</a></dt>
<dd><p>Transform MCMC trace to age models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trace</strong> (<em>arviz.InferenceData</em>) – ArviZ InferenceData object containing the MCMC trace.</p></li>
<li><p><strong>h</strong> (<em>arraylike</em>) – Heights at which to evaluate the age model.</p></li>
<li><p><strong>n_posterior</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – Number of posterior samples. Defaults to None.</p></li>
<li><p><strong>n_jobs</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – Number of parallel jobs. Defaults to 1. If 1, no parallelization is used. Uses joblib.Parallel for parallelization.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – Method for optimization in fit_floating_model(). ‘max’ for maximum likelihood, ‘random’ for random sampling of alignment likelihood. Defaults to ‘random’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>list</strong> – List of age models; each element is a nx2 array of unit bottom and top times for n units.</p></li>
<li><p><strong>numpy.ndarray</strong> – Array of age models at heights h; each row is an age model. Shape is (n_posterior, len(h)). Only returned if h is not None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stratage.stratage.DT_logp_l_gen">
<span class="sig-prename descclassname"><span class="pre">stratage.stratage.</span></span><span class="sig-name descname"><span class="pre">DT_logp_l_gen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#DT_logp_l_gen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.stratage.DT_logp_l_gen" title="Link to this definition">¶</a></dt>
<dd><p>Generates a log-probability function for a numerical time increment distribution. Returned function interpolates a log probability and takes as inputs time increment(s) at which to evaluate as well as (required) time increment coordinates corresponding to the numerical pdf associated with the function. Sped up with numba.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pdt</strong> (<em>array-like</em>) – The probability density function values for the time increments.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>numba.core.registry.CPUDispatcher</strong> – A function that computes the log-probability of a given time increment.
The returned function, DT_logp, takes the following parameters:</p>
<blockquote>
<div><p>dt_query (float): The time increment for which the log-probability is to be computed.
dt (array-like): The array of time increments corresponding to the probability density function values. Must be same length as pdt.</p>
</div></blockquote>
<p>The DT_logp function computes the log-probability by interpolating the probability density function values and applying sigmoid functions to ensure the values are within the valid range.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stratage.stratage.age">
<span class="sig-prename descclassname"><span class="pre">stratage.stratage.</span></span><span class="sig-name descname"><span class="pre">age</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#age"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.stratage.age" title="Link to this definition">¶</a></dt>
<dd><p>Interpolate time at given heights in strat. Times at contact heights are returned as the age of the top of the unit below the contact.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>times</strong> (<em>arraylike</em>) – nx2 array of unit bottom and top times for n units.</p></li>
<li><p><strong>units</strong> (<em>arraylike</em>) – nx2 array of unit bottom and top heights for n units.</p></li>
<li><p><strong>heights</strong> (<em>arraylike</em>) – Height(s) at which to evaluate the age model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>array</strong> – Age(s) at the given height(s).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stratage.stratage.age_depth">
<span class="sig-prename descclassname"><span class="pre">stratage.stratage.</span></span><span class="sig-name descname"><span class="pre">age_depth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">times</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#age_depth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.stratage.age_depth" title="Link to this definition">¶</a></dt>
<dd><p>Convert units, times arrays to age-depth curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>units</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – An nx2 array of bottom and top elevations for each of n units.</p></li>
<li><p><strong>times</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – An nx2 array of bottom and top times for each of n units.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>numpy.ndarray</strong> – Vector of ages for each unit.</p></li>
<li><p><strong>numpy.ndarray</strong> – Vector of heights for each unit.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stratage.stratage.fit_floating_model">
<span class="sig-prename descclassname"><span class="pre">stratage.stratage.</span></span><span class="sig-name descname"><span class="pre">fit_floating_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sed_rates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hiatuses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geochron</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'random'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#fit_floating_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.stratage.fit_floating_model" title="Link to this definition">¶</a></dt>
<dd><p>Fit a floating age model to geochronologic constraints</p>
<p>Two methods are implemented. One (method=’max’) maximizes the likelihood of alignment with the geochronologic constraints by using scipy.optimize.minimize_scalar to minimize the negative log likelihood of a time offset with respect to the distributions in absolute time of the geochronologic constraints.</p>
<p>The other (method=’random’) samples from the total alignment likelihood and selects a random offset that is consistent with the likelihood. This method is the default.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sed_rates</strong> (<em>arraylike</em>) – Sedimentation rates for each unit.</p></li>
<li><p><strong>hiatuses</strong> (<em>arraylike</em>) – Hiatuses between units. Must be len(sed_rates)-1.</p></li>
<li><p><strong>units</strong> (<em>ndarray</em>) – nx2 array of unit bottom and top heights for n units.</p></li>
<li><p><strong>geochron</strong> (<a class="reference internal" href="#stratage.geochron.Geochron" title="stratage.geochron.Geochron"><em>geochron.Geochron</em></a>) – Geochron object containing geochron constraints.</p></li>
<li><p><strong>tol</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – Tolerance for bounds on optimization. Defaults to 1e-6.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – Method for optimization. ‘max’ for maximum likelihood, ‘random’ for random sampling of alignment likelihood. Defaults to ‘random’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ndarray</strong> – nx2 array of unit bottom and top ages for n units in absolute time</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stratage.stratage.floating_age">
<span class="sig-prename descclassname"><span class="pre">stratage.stratage.</span></span><span class="sig-name descname"><span class="pre">floating_age</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sed_rates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hiatuses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#floating_age"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.stratage.floating_age" title="Link to this definition">¶</a></dt>
<dd><p>Floating ages at heights in strat. Assumes t=0 at base of section. Times at contact heights are returned as the age of the top of the unit below the contact.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sed_rates</strong> (<em>arraylike</em>) – Sedimentation rates for each unit.</p></li>
<li><p><strong>hiatuses</strong> (<em>arraylike</em>) – Hiatuses between units. Must be len(sed_rates)-1.</p></li>
<li><p><strong>units</strong> (<em>arraylike</em>) – nx2 array of unit bottom and top heights for n units.</p></li>
<li><p><strong>heights</strong> (<em>arraylike</em><em> | </em><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Height(s) at which to evaluate the age model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>array</strong> – Age(s) at the given height(s).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stratage.stratage.geochron_height_check">
<span class="sig-prename descclassname"><span class="pre">stratage.stratage.</span></span><span class="sig-name descname"><span class="pre">geochron_height_check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unit_heights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geochron_heights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#geochron_height_check"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.stratage.geochron_height_check" title="Link to this definition">¶</a></dt>
<dd><p>Ensure that geochron heights are within units and not at contacts. Also ensure that geochron heights are within the section. Run before trimming section to the top and bottom of the geochron constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>unit_heights</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – Bottom and top heights of units in section.
2d array (nx2) of bottom and top heights for each of n units</p></li>
<li><p><strong>geochron_heights</strong> (<em>arraylike</em>) – Heights of geochron constraints in the section</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#AssertionError" title="(in Python v3.12)"><strong>AssertionError</strong></a> – If any of the geochron heights are below the section or above the section.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#AssertionError" title="(in Python v3.12)"><strong>AssertionError</strong></a> – If any of the geochron heights are at contacts.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stratage.stratage.get_times">
<span class="sig-prename descclassname"><span class="pre">stratage.stratage.</span></span><span class="sig-name descname"><span class="pre">get_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sed_rates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hiatuses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#get_times"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.stratage.get_times" title="Link to this definition">¶</a></dt>
<dd><p>Floating times array for units.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sed_rates</strong> (<em>arraylike</em>) – Sedimentation rates for each unit</p></li>
<li><p><strong>hiatuses</strong> (<em>arraylike</em>) – Hiatuses between units</p></li>
<li><p><strong>units</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – Bottom and top heights of units in section.
2d array (nx2) of bottom and top heights for each of n units</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>times</strong> (<em>numpy.ndarray</em>) – Floating times array for units, same shape as units</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stratage.stratage.loglike_gen">
<span class="sig-prename descclassname"><span class="pre">stratage.stratage.</span></span><span class="sig-name descname"><span class="pre">loglike_gen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geochron</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#loglike_gen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.stratage.loglike_gen" title="Link to this definition">¶</a></dt>
<dd><p>Returns log-likelihood object for use in PyMC.CustomDist as a likelihood for posterior sampling. See subfunction eps_logp for details on the log-likelihood computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geochron</strong> (<a class="reference internal" href="#stratage.geochron.Geochron" title="stratage.geochron.Geochron"><em>geochron.Geochron</em></a>) – Geochron object containing geochronologic constraints.</p></li>
<li><p><strong>units</strong> (<em>ndarray</em>) – nx2 array of unit bottom and top heights for n units.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>LogLike</strong> – PyTensor Op class for likelihood evaluation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stratage.stratage.model_ls">
<span class="sig-prename descclassname"><span class="pre">stratage.stratage.</span></span><span class="sig-name descname"><span class="pre">model_ls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geochron</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sed_rate_bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hiatus_bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#model_ls"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.stratage.model_ls" title="Link to this definition">¶</a></dt>
<dd><p>Least squares age model fitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>units</strong> (<em>ndarray</em>) – nx2 array of unit bottom and top heights for n units.</p></li>
<li><p><strong>geochron</strong> (<a class="reference internal" href="#stratage.geochron.Geochron" title="stratage.geochron.Geochron"><em>geochron.Geochron</em></a>) – Geochron object containing geochron constraints.</p></li>
<li><p><strong>sed_rate_bounds</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>, </em><em>optional</em>) – Bounds on sedimentation rates. Defaults to None.</p></li>
<li><p><strong>hiatus_bounds</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>, </em><em>optional</em>) – Bounds on hiatuses. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sed_rates</strong> (<em>numpy.ndarray</em>) – Sedimentation rates for each unit.</p></li>
<li><p><strong>hiatuses</strong> (<em>numpy.ndarray</em>) – Hiatuses between units.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stratage.stratage.randlike_gen">
<span class="sig-prename descclassname"><span class="pre">stratage.stratage.</span></span><span class="sig-name descname"><span class="pre">randlike_gen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geochron</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#randlike_gen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.stratage.randlike_gen" title="Link to this definition">¶</a></dt>
<dd><p>Generate function for generating random draws from likelihood. Permits generating prior_predictive samples from a model with the CustomDist likelihood.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geochron</strong> (<a class="reference internal" href="#stratage.geochron.Geochron" title="stratage.geochron.Geochron"><em>geochron.Geochron</em></a>) – Geochron object containing geochronologic constraints.</p></li>
<li><p><strong>units</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – Bottom and top heights of units in section.
2d array (nx2) of bottom and top heights for each of n units</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>function</strong> – Function for generating random draws from likelihood.
The returned function, eps_rand, takes the following parameters:</p>
<blockquote>
<div><div class="line-block">
<div class="line">params (array-like): Array of parameters; concatenation of sedimentation rates and hiatuses.</div>
<div class="line">rng (numpy.random.Generator): Random number generator.</div>
<div class="line">size (int or tuple of ints, optional): Output shape. Default is None. Last dimension must be the number of pairs of geochron constraints.</div>
</div>
</div></blockquote>
<p>The function returns a numpy.ndarray of random draws.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stratage.stratage.sigmoid">
<span class="sig-prename descclassname"><span class="pre">stratage.stratage.</span></span><span class="sig-name descname"><span class="pre">sigmoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#sigmoid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.stratage.sigmoid" title="Link to this definition">¶</a></dt>
<dd><p>Sigmoid function for numerical stability.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em> | </em><em>arraylike</em>) – Value to apply sigmoid to.</p></li>
<li><p><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – Transition width scale of sigmoid. Defaults to 0.001.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>float | arraylike</strong> – Sigmoid applied to t.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stratage.stratage.trim_units">
<span class="sig-prename descclassname"><span class="pre">stratage.stratage.</span></span><span class="sig-name descname"><span class="pre">trim_units</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unit_heights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geochron_heights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#trim_units"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.stratage.trim_units" title="Link to this definition">¶</a></dt>
<dd><p>Trim the top and bottom of the section to the top and bottom of the geochron constraints. Run after geochron_height_check.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>unit_heights</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – Bottom and top heights of units in section.
2d array-like (nx2) of bottom and top heights for each of n units</p></li>
<li><p><strong>geochron_heights</strong> (<em>arraylike</em>) – Heights of geochron constraints in section</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>numpy.ndarray</strong> – Trimmed unit heights after adjusting for the top and bottom units</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>None</strong> – </p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-stratage">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-stratage" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="stratage.AgeModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stratage.</span></span><span class="sig-name descname"><span class="pre">AgeModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geochron</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sed_rates_prior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hiatuses_prior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#AgeModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.AgeModel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.12/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Age model object for Bayesian inference of sedimentation rates and hiatuses.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="stratage.AgeModel.units">
<span class="sig-name descname"><span class="pre">units</span></span><a class="headerlink" href="#stratage.AgeModel.units" title="Link to this definition">¶</a></dt>
<dd><p>nx2 array of unit bottom and top heights for n units.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stratage.AgeModel.geochron">
<span class="sig-name descname"><span class="pre">geochron</span></span><a class="headerlink" href="#stratage.AgeModel.geochron" title="Link to this definition">¶</a></dt>
<dd><p>Geochron object containing geochron constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#stratage.geochron.Geochron" title="stratage.geochron.Geochron">geochron.Geochron</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stratage.AgeModel.sed_rates_prior">
<span class="sig-name descname"><span class="pre">sed_rates_prior</span></span><a class="headerlink" href="#stratage.AgeModel.sed_rates_prior" title="Link to this definition">¶</a></dt>
<dd><p>Prior distribution for sedimentation rates. Must be valid as dist argument to pymc.CustomDist(dist=dist). Signature is sed_rate_prior(size=size).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>function</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stratage.AgeModel.hiatuses_prior">
<span class="sig-name descname"><span class="pre">hiatuses_prior</span></span><a class="headerlink" href="#stratage.AgeModel.hiatuses_prior" title="Link to this definition">¶</a></dt>
<dd><p>Prior distribution for hiatuses. Must be valid as dist argument to pymc.CustomDist(dist=dist). Signature is hiatus_prior(size=size).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>function</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stratage.AgeModel.n_units">
<span class="sig-name descname"><span class="pre">n_units</span></span><a class="headerlink" href="#stratage.AgeModel.n_units" title="Link to this definition">¶</a></dt>
<dd><p>Number of units.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stratage.AgeModel.n_contacts">
<span class="sig-name descname"><span class="pre">n_contacts</span></span><a class="headerlink" href="#stratage.AgeModel.n_contacts" title="Link to this definition">¶</a></dt>
<dd><p>Number of contacts.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stratage.AgeModel.units_trim">
<span class="sig-name descname"><span class="pre">units_trim</span></span><a class="headerlink" href="#stratage.AgeModel.units_trim" title="Link to this definition">¶</a></dt>
<dd><p>Trimmed unit heights after adjusting for the top and bottom units.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stratage.AgeModel.sed_rates_ls">
<span class="sig-name descname"><span class="pre">sed_rates_ls</span></span><a class="headerlink" href="#stratage.AgeModel.sed_rates_ls" title="Link to this definition">¶</a></dt>
<dd><p>Sedimentation rates from least squares model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stratage.AgeModel.hiatuses_ls">
<span class="sig-name descname"><span class="pre">hiatuses_ls</span></span><a class="headerlink" href="#stratage.AgeModel.hiatuses_ls" title="Link to this definition">¶</a></dt>
<dd><p>Hiatuses from least squares model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stratage.AgeModel.model">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#stratage.AgeModel.model" title="Link to this definition">¶</a></dt>
<dd><p>PyMC model object for Bayesian inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pymc.Model</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stratage.AgeModel.vars_list">
<span class="sig-name descname"><span class="pre">vars_list</span></span><a class="headerlink" href="#stratage.AgeModel.vars_list" title="Link to this definition">¶</a></dt>
<dd><p>List of variables in the pymc.model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#list" title="(in Python v3.12)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stratage.AgeModel.fit_absolute_age">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fit_absolute_age</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ii</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sed_rates_post</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hiatuses_post</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units_trim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geochron</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#AgeModel.fit_absolute_age"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.AgeModel.fit_absolute_age" title="Link to this definition">¶</a></dt>
<dd><p>Fit the age model for the ii-th sample of the posterior.</p>
<p>Static method to work with joblib.Parallel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ii</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Index of the posterior sample.</p></li>
<li><p><strong>sed_rates_post</strong> (<em>ndarray</em>) – Sedimentation rates for each unit, ii-th posterior sample.</p></li>
<li><p><strong>hiatuses_post</strong> (<em>ndarray</em>) – Hiatuses between units, ii-th posterior sample.</p></li>
<li><p><strong>units_trim</strong> (<em>ndarray</em>) – Trimmed unit heights after adjusting for the top and bottom units.</p></li>
<li><p><strong>geochron</strong> (<a class="reference internal" href="#stratage.geochron.Geochron" title="stratage.geochron.Geochron"><em>Geochron</em></a>) – Geochron object containing geochron constraints.</p></li>
<li><p><strong>h</strong> (<em>arraylike</em>) – Heights at which to evaluate the age model.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Method for optimization in fit_floating_model(). ‘max’ for maximum likelihood, ‘random’ for random sampling of alignment likelihood.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ndarray</strong> – Ages at the given height(s).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stratage.AgeModel.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">draws</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#AgeModel.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.AgeModel.sample" title="Link to this definition">¶</a></dt>
<dd><p>Sample posterior distribution of sedimentation rates and hiatus durations.</p>
<p>The output of this function must be transformed to age models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>draws</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – Number of posterior draws. Defaults to 1000.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>arviz.InferenceData</strong> – ArviZ InferenceData object containing the MCMC trace.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stratage.AgeModel.sample_prior">
<span class="sig-name descname"><span class="pre">sample_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">draws</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#AgeModel.sample_prior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.AgeModel.sample_prior" title="Link to this definition">¶</a></dt>
<dd><p>Sample prior predictive distribution of age models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>draws</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – Number of prior predictive draws. Defaults to 100.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>list</strong> – List of prior predictive samples of times; each element is a nx2 array of unit bottom and top times for n units.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stratage.AgeModel.trace2ages">
<span class="sig-name descname"><span class="pre">trace2ages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_posterior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'random'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#AgeModel.trace2ages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.AgeModel.trace2ages" title="Link to this definition">¶</a></dt>
<dd><p>Transform MCMC trace to age models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trace</strong> (<em>arviz.InferenceData</em>) – ArviZ InferenceData object containing the MCMC trace.</p></li>
<li><p><strong>h</strong> (<em>arraylike</em>) – Heights at which to evaluate the age model.</p></li>
<li><p><strong>n_posterior</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – Number of posterior samples. Defaults to None.</p></li>
<li><p><strong>n_jobs</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – Number of parallel jobs. Defaults to 1. If 1, no parallelization is used. Uses joblib.Parallel for parallelization.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – Method for optimization in fit_floating_model(). ‘max’ for maximum likelihood, ‘random’ for random sampling of alignment likelihood. Defaults to ‘random’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>list</strong> – List of age models; each element is a nx2 array of unit bottom and top times for n units.</p></li>
<li><p><strong>numpy.ndarray</strong> – Array of age models at heights h; each row is an age model. Shape is (n_posterior, len(h)). Only returned if h is not None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stratage.DT_logp_l_gen">
<span class="sig-prename descclassname"><span class="pre">stratage.</span></span><span class="sig-name descname"><span class="pre">DT_logp_l_gen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#DT_logp_l_gen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.DT_logp_l_gen" title="Link to this definition">¶</a></dt>
<dd><p>Generates a log-probability function for a numerical time increment distribution. Returned function interpolates a log probability and takes as inputs time increment(s) at which to evaluate as well as (required) time increment coordinates corresponding to the numerical pdf associated with the function. Sped up with numba.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pdt</strong> (<em>array-like</em>) – The probability density function values for the time increments.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>numba.core.registry.CPUDispatcher</strong> – A function that computes the log-probability of a given time increment.
The returned function, DT_logp, takes the following parameters:</p>
<blockquote>
<div><p>dt_query (float): The time increment for which the log-probability is to be computed.
dt (array-like): The array of time increments corresponding to the probability density function values. Must be same length as pdt.</p>
</div></blockquote>
<p>The DT_logp function computes the log-probability by interpolating the probability density function values and applying sigmoid functions to ensure the values are within the valid range.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stratage.age">
<span class="sig-prename descclassname"><span class="pre">stratage.</span></span><span class="sig-name descname"><span class="pre">age</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#age"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.age" title="Link to this definition">¶</a></dt>
<dd><p>Interpolate time at given heights in strat. Times at contact heights are returned as the age of the top of the unit below the contact.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>times</strong> (<em>arraylike</em>) – nx2 array of unit bottom and top times for n units.</p></li>
<li><p><strong>units</strong> (<em>arraylike</em>) – nx2 array of unit bottom and top heights for n units.</p></li>
<li><p><strong>heights</strong> (<em>arraylike</em>) – Height(s) at which to evaluate the age model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>array</strong> – Age(s) at the given height(s).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stratage.age_depth">
<span class="sig-prename descclassname"><span class="pre">stratage.</span></span><span class="sig-name descname"><span class="pre">age_depth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">times</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#age_depth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.age_depth" title="Link to this definition">¶</a></dt>
<dd><p>Convert units, times arrays to age-depth curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>units</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – An nx2 array of bottom and top elevations for each of n units.</p></li>
<li><p><strong>times</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – An nx2 array of bottom and top times for each of n units.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>numpy.ndarray</strong> – Vector of ages for each unit.</p></li>
<li><p><strong>numpy.ndarray</strong> – Vector of heights for each unit.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stratage.fit_floating_model">
<span class="sig-prename descclassname"><span class="pre">stratage.</span></span><span class="sig-name descname"><span class="pre">fit_floating_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sed_rates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hiatuses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geochron</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'random'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#fit_floating_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.fit_floating_model" title="Link to this definition">¶</a></dt>
<dd><p>Fit a floating age model to geochronologic constraints</p>
<p>Two methods are implemented. One (method=’max’) maximizes the likelihood of alignment with the geochronologic constraints by using scipy.optimize.minimize_scalar to minimize the negative log likelihood of a time offset with respect to the distributions in absolute time of the geochronologic constraints.</p>
<p>The other (method=’random’) samples from the total alignment likelihood and selects a random offset that is consistent with the likelihood. This method is the default.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sed_rates</strong> (<em>arraylike</em>) – Sedimentation rates for each unit.</p></li>
<li><p><strong>hiatuses</strong> (<em>arraylike</em>) – Hiatuses between units. Must be len(sed_rates)-1.</p></li>
<li><p><strong>units</strong> (<em>ndarray</em>) – nx2 array of unit bottom and top heights for n units.</p></li>
<li><p><strong>geochron</strong> (<a class="reference internal" href="#stratage.geochron.Geochron" title="stratage.geochron.Geochron"><em>geochron.Geochron</em></a>) – Geochron object containing geochron constraints.</p></li>
<li><p><strong>tol</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – Tolerance for bounds on optimization. Defaults to 1e-6.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – Method for optimization. ‘max’ for maximum likelihood, ‘random’ for random sampling of alignment likelihood. Defaults to ‘random’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ndarray</strong> – nx2 array of unit bottom and top ages for n units in absolute time</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stratage.floating_age">
<span class="sig-prename descclassname"><span class="pre">stratage.</span></span><span class="sig-name descname"><span class="pre">floating_age</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sed_rates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hiatuses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#floating_age"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.floating_age" title="Link to this definition">¶</a></dt>
<dd><p>Floating ages at heights in strat. Assumes t=0 at base of section. Times at contact heights are returned as the age of the top of the unit below the contact.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sed_rates</strong> (<em>arraylike</em>) – Sedimentation rates for each unit.</p></li>
<li><p><strong>hiatuses</strong> (<em>arraylike</em>) – Hiatuses between units. Must be len(sed_rates)-1.</p></li>
<li><p><strong>units</strong> (<em>arraylike</em>) – nx2 array of unit bottom and top heights for n units.</p></li>
<li><p><strong>heights</strong> (<em>arraylike</em><em> | </em><a class="reference external" href="https://docs.python.org/3.12/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Height(s) at which to evaluate the age model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>array</strong> – Age(s) at the given height(s).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stratage.geochron_height_check">
<span class="sig-prename descclassname"><span class="pre">stratage.</span></span><span class="sig-name descname"><span class="pre">geochron_height_check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unit_heights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geochron_heights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#geochron_height_check"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.geochron_height_check" title="Link to this definition">¶</a></dt>
<dd><p>Ensure that geochron heights are within units and not at contacts. Also ensure that geochron heights are within the section. Run before trimming section to the top and bottom of the geochron constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>unit_heights</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – Bottom and top heights of units in section.
2d array (nx2) of bottom and top heights for each of n units</p></li>
<li><p><strong>geochron_heights</strong> (<em>arraylike</em>) – Heights of geochron constraints in the section</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#AssertionError" title="(in Python v3.12)"><strong>AssertionError</strong></a> – If any of the geochron heights are below the section or above the section.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3.12/library/exceptions.html#AssertionError" title="(in Python v3.12)"><strong>AssertionError</strong></a> – If any of the geochron heights are at contacts.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stratage.get_times">
<span class="sig-prename descclassname"><span class="pre">stratage.</span></span><span class="sig-name descname"><span class="pre">get_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sed_rates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hiatuses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#get_times"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.get_times" title="Link to this definition">¶</a></dt>
<dd><p>Floating times array for units.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sed_rates</strong> (<em>arraylike</em>) – Sedimentation rates for each unit</p></li>
<li><p><strong>hiatuses</strong> (<em>arraylike</em>) – Hiatuses between units</p></li>
<li><p><strong>units</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – Bottom and top heights of units in section.
2d array (nx2) of bottom and top heights for each of n units</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>times</strong> (<em>numpy.ndarray</em>) – Floating times array for units, same shape as units</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stratage.loglike_gen">
<span class="sig-prename descclassname"><span class="pre">stratage.</span></span><span class="sig-name descname"><span class="pre">loglike_gen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geochron</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#loglike_gen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.loglike_gen" title="Link to this definition">¶</a></dt>
<dd><p>Returns log-likelihood object for use in PyMC.CustomDist as a likelihood for posterior sampling. See subfunction eps_logp for details on the log-likelihood computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geochron</strong> (<a class="reference internal" href="#stratage.geochron.Geochron" title="stratage.geochron.Geochron"><em>geochron.Geochron</em></a>) – Geochron object containing geochronologic constraints.</p></li>
<li><p><strong>units</strong> (<em>ndarray</em>) – nx2 array of unit bottom and top heights for n units.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>LogLike</strong> – PyTensor Op class for likelihood evaluation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stratage.model_ls">
<span class="sig-prename descclassname"><span class="pre">stratage.</span></span><span class="sig-name descname"><span class="pre">model_ls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geochron</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sed_rate_bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hiatus_bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#model_ls"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.model_ls" title="Link to this definition">¶</a></dt>
<dd><p>Least squares age model fitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>units</strong> (<em>ndarray</em>) – nx2 array of unit bottom and top heights for n units.</p></li>
<li><p><strong>geochron</strong> (<a class="reference internal" href="#stratage.geochron.Geochron" title="stratage.geochron.Geochron"><em>geochron.Geochron</em></a>) – Geochron object containing geochron constraints.</p></li>
<li><p><strong>sed_rate_bounds</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>, </em><em>optional</em>) – Bounds on sedimentation rates. Defaults to None.</p></li>
<li><p><strong>hiatus_bounds</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>, </em><em>optional</em>) – Bounds on hiatuses. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sed_rates</strong> (<em>numpy.ndarray</em>) – Sedimentation rates for each unit.</p></li>
<li><p><strong>hiatuses</strong> (<em>numpy.ndarray</em>) – Hiatuses between units.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stratage.randlike_gen">
<span class="sig-prename descclassname"><span class="pre">stratage.</span></span><span class="sig-name descname"><span class="pre">randlike_gen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geochron</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#randlike_gen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.randlike_gen" title="Link to this definition">¶</a></dt>
<dd><p>Generate function for generating random draws from likelihood. Permits generating prior_predictive samples from a model with the CustomDist likelihood.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geochron</strong> (<a class="reference internal" href="#stratage.geochron.Geochron" title="stratage.geochron.Geochron"><em>geochron.Geochron</em></a>) – Geochron object containing geochronologic constraints.</p></li>
<li><p><strong>units</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – Bottom and top heights of units in section.
2d array (nx2) of bottom and top heights for each of n units</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>function</strong> – Function for generating random draws from likelihood.
The returned function, eps_rand, takes the following parameters:</p>
<blockquote>
<div><div class="line-block">
<div class="line">params (array-like): Array of parameters; concatenation of sedimentation rates and hiatuses.</div>
<div class="line">rng (numpy.random.Generator): Random number generator.</div>
<div class="line">size (int or tuple of ints, optional): Output shape. Default is None. Last dimension must be the number of pairs of geochron constraints.</div>
</div>
</div></blockquote>
<p>The function returns a numpy.ndarray of random draws.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stratage.sigmoid">
<span class="sig-prename descclassname"><span class="pre">stratage.</span></span><span class="sig-name descname"><span class="pre">sigmoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#sigmoid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.sigmoid" title="Link to this definition">¶</a></dt>
<dd><p>Sigmoid function for numerical stability.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em> | </em><em>arraylike</em>) – Value to apply sigmoid to.</p></li>
<li><p><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3.12/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – Transition width scale of sigmoid. Defaults to 0.001.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>float | arraylike</strong> – Sigmoid applied to t.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stratage.trim_units">
<span class="sig-prename descclassname"><span class="pre">stratage.</span></span><span class="sig-name descname"><span class="pre">trim_units</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unit_heights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geochron_heights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stratage/stratage.html#trim_units"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stratage.trim_units" title="Link to this definition">¶</a></dt>
<dd><p>Trim the top and bottom of the section to the top and bottom of the geochron constraints. Run after geochron_height_check.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>unit_heights</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – Bottom and top heights of units in section.
2d array-like (nx2) of bottom and top heights for each of n units</p></li>
<li><p><strong>geochron_heights</strong> (<em>arraylike</em>) – Heights of geochron constraints in section</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>numpy.ndarray</strong> – Trimmed unit heights after adjusting for the top and bottom units</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>None</strong> – </p>
</dd>
</dl>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../license.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">License</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="modules.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">stratage</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Adrian Tasistro-Hart
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">stratage package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-stratage.geochron">stratage.geochron module</a><ul>
<li><a class="reference internal" href="#stratage.geochron.Geochron"><code class="docutils literal notranslate"><span class="pre">Geochron</span></code></a><ul>
<li><a class="reference internal" href="#stratage.geochron.Geochron.h"><code class="docutils literal notranslate"><span class="pre">Geochron.h</span></code></a></li>
<li><a class="reference internal" href="#stratage.geochron.Geochron.rv"><code class="docutils literal notranslate"><span class="pre">Geochron.rv</span></code></a></li>
<li><a class="reference internal" href="#stratage.geochron.Geochron.n_constraints"><code class="docutils literal notranslate"><span class="pre">Geochron.n_constraints</span></code></a></li>
<li><a class="reference internal" href="#stratage.geochron.Geochron.n_pairs"><code class="docutils literal notranslate"><span class="pre">Geochron.n_pairs</span></code></a></li>
<li><a class="reference internal" href="#stratage.geochron.Geochron.nt"><code class="docutils literal notranslate"><span class="pre">Geochron.nt</span></code></a></li>
<li><a class="reference internal" href="#stratage.geochron.Geochron.ndt"><code class="docutils literal notranslate"><span class="pre">Geochron.ndt</span></code></a></li>
<li><a class="reference internal" href="#stratage.geochron.Geochron.lower_idx"><code class="docutils literal notranslate"><span class="pre">Geochron.lower_idx</span></code></a></li>
<li><a class="reference internal" href="#stratage.geochron.Geochron.model_weights"><code class="docutils literal notranslate"><span class="pre">Geochron.model_weights()</span></code></a></li>
<li><a class="reference internal" href="#stratage.geochron.Geochron.plot_constraints"><code class="docutils literal notranslate"><span class="pre">Geochron.plot_constraints()</span></code></a></li>
<li><a class="reference internal" href="#stratage.geochron.Geochron.plot_increment_pdfs"><code class="docutils literal notranslate"><span class="pre">Geochron.plot_increment_pdfs()</span></code></a></li>
<li><a class="reference internal" href="#stratage.geochron.Geochron.straddling"><code class="docutils literal notranslate"><span class="pre">Geochron.straddling()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-stratage.stratage">stratage.stratage module</a><ul>
<li><a class="reference internal" href="#stratage.stratage.AgeModel"><code class="docutils literal notranslate"><span class="pre">AgeModel</span></code></a><ul>
<li><a class="reference internal" href="#stratage.stratage.AgeModel.units"><code class="docutils literal notranslate"><span class="pre">AgeModel.units</span></code></a></li>
<li><a class="reference internal" href="#stratage.stratage.AgeModel.geochron"><code class="docutils literal notranslate"><span class="pre">AgeModel.geochron</span></code></a></li>
<li><a class="reference internal" href="#stratage.stratage.AgeModel.sed_rates_prior"><code class="docutils literal notranslate"><span class="pre">AgeModel.sed_rates_prior</span></code></a></li>
<li><a class="reference internal" href="#stratage.stratage.AgeModel.hiatuses_prior"><code class="docutils literal notranslate"><span class="pre">AgeModel.hiatuses_prior</span></code></a></li>
<li><a class="reference internal" href="#stratage.stratage.AgeModel.n_units"><code class="docutils literal notranslate"><span class="pre">AgeModel.n_units</span></code></a></li>
<li><a class="reference internal" href="#stratage.stratage.AgeModel.n_contacts"><code class="docutils literal notranslate"><span class="pre">AgeModel.n_contacts</span></code></a></li>
<li><a class="reference internal" href="#stratage.stratage.AgeModel.units_trim"><code class="docutils literal notranslate"><span class="pre">AgeModel.units_trim</span></code></a></li>
<li><a class="reference internal" href="#stratage.stratage.AgeModel.sed_rates_ls"><code class="docutils literal notranslate"><span class="pre">AgeModel.sed_rates_ls</span></code></a></li>
<li><a class="reference internal" href="#stratage.stratage.AgeModel.hiatuses_ls"><code class="docutils literal notranslate"><span class="pre">AgeModel.hiatuses_ls</span></code></a></li>
<li><a class="reference internal" href="#stratage.stratage.AgeModel.model"><code class="docutils literal notranslate"><span class="pre">AgeModel.model</span></code></a></li>
<li><a class="reference internal" href="#stratage.stratage.AgeModel.vars_list"><code class="docutils literal notranslate"><span class="pre">AgeModel.vars_list</span></code></a></li>
<li><a class="reference internal" href="#stratage.stratage.AgeModel.fit_absolute_age"><code class="docutils literal notranslate"><span class="pre">AgeModel.fit_absolute_age()</span></code></a></li>
<li><a class="reference internal" href="#stratage.stratage.AgeModel.sample"><code class="docutils literal notranslate"><span class="pre">AgeModel.sample()</span></code></a></li>
<li><a class="reference internal" href="#stratage.stratage.AgeModel.sample_prior"><code class="docutils literal notranslate"><span class="pre">AgeModel.sample_prior()</span></code></a></li>
<li><a class="reference internal" href="#stratage.stratage.AgeModel.trace2ages"><code class="docutils literal notranslate"><span class="pre">AgeModel.trace2ages()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#stratage.stratage.DT_logp_l_gen"><code class="docutils literal notranslate"><span class="pre">DT_logp_l_gen()</span></code></a></li>
<li><a class="reference internal" href="#stratage.stratage.age"><code class="docutils literal notranslate"><span class="pre">age()</span></code></a></li>
<li><a class="reference internal" href="#stratage.stratage.age_depth"><code class="docutils literal notranslate"><span class="pre">age_depth()</span></code></a></li>
<li><a class="reference internal" href="#stratage.stratage.fit_floating_model"><code class="docutils literal notranslate"><span class="pre">fit_floating_model()</span></code></a></li>
<li><a class="reference internal" href="#stratage.stratage.floating_age"><code class="docutils literal notranslate"><span class="pre">floating_age()</span></code></a></li>
<li><a class="reference internal" href="#stratage.stratage.geochron_height_check"><code class="docutils literal notranslate"><span class="pre">geochron_height_check()</span></code></a></li>
<li><a class="reference internal" href="#stratage.stratage.get_times"><code class="docutils literal notranslate"><span class="pre">get_times()</span></code></a></li>
<li><a class="reference internal" href="#stratage.stratage.loglike_gen"><code class="docutils literal notranslate"><span class="pre">loglike_gen()</span></code></a></li>
<li><a class="reference internal" href="#stratage.stratage.model_ls"><code class="docutils literal notranslate"><span class="pre">model_ls()</span></code></a></li>
<li><a class="reference internal" href="#stratage.stratage.randlike_gen"><code class="docutils literal notranslate"><span class="pre">randlike_gen()</span></code></a></li>
<li><a class="reference internal" href="#stratage.stratage.sigmoid"><code class="docutils literal notranslate"><span class="pre">sigmoid()</span></code></a></li>
<li><a class="reference internal" href="#stratage.stratage.trim_units"><code class="docutils literal notranslate"><span class="pre">trim_units()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-stratage">Module contents</a><ul>
<li><a class="reference internal" href="#stratage.AgeModel"><code class="docutils literal notranslate"><span class="pre">AgeModel</span></code></a><ul>
<li><a class="reference internal" href="#stratage.AgeModel.units"><code class="docutils literal notranslate"><span class="pre">AgeModel.units</span></code></a></li>
<li><a class="reference internal" href="#stratage.AgeModel.geochron"><code class="docutils literal notranslate"><span class="pre">AgeModel.geochron</span></code></a></li>
<li><a class="reference internal" href="#stratage.AgeModel.sed_rates_prior"><code class="docutils literal notranslate"><span class="pre">AgeModel.sed_rates_prior</span></code></a></li>
<li><a class="reference internal" href="#stratage.AgeModel.hiatuses_prior"><code class="docutils literal notranslate"><span class="pre">AgeModel.hiatuses_prior</span></code></a></li>
<li><a class="reference internal" href="#stratage.AgeModel.n_units"><code class="docutils literal notranslate"><span class="pre">AgeModel.n_units</span></code></a></li>
<li><a class="reference internal" href="#stratage.AgeModel.n_contacts"><code class="docutils literal notranslate"><span class="pre">AgeModel.n_contacts</span></code></a></li>
<li><a class="reference internal" href="#stratage.AgeModel.units_trim"><code class="docutils literal notranslate"><span class="pre">AgeModel.units_trim</span></code></a></li>
<li><a class="reference internal" href="#stratage.AgeModel.sed_rates_ls"><code class="docutils literal notranslate"><span class="pre">AgeModel.sed_rates_ls</span></code></a></li>
<li><a class="reference internal" href="#stratage.AgeModel.hiatuses_ls"><code class="docutils literal notranslate"><span class="pre">AgeModel.hiatuses_ls</span></code></a></li>
<li><a class="reference internal" href="#stratage.AgeModel.model"><code class="docutils literal notranslate"><span class="pre">AgeModel.model</span></code></a></li>
<li><a class="reference internal" href="#stratage.AgeModel.vars_list"><code class="docutils literal notranslate"><span class="pre">AgeModel.vars_list</span></code></a></li>
<li><a class="reference internal" href="#stratage.AgeModel.fit_absolute_age"><code class="docutils literal notranslate"><span class="pre">AgeModel.fit_absolute_age()</span></code></a></li>
<li><a class="reference internal" href="#stratage.AgeModel.sample"><code class="docutils literal notranslate"><span class="pre">AgeModel.sample()</span></code></a></li>
<li><a class="reference internal" href="#stratage.AgeModel.sample_prior"><code class="docutils literal notranslate"><span class="pre">AgeModel.sample_prior()</span></code></a></li>
<li><a class="reference internal" href="#stratage.AgeModel.trace2ages"><code class="docutils literal notranslate"><span class="pre">AgeModel.trace2ages()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#stratage.DT_logp_l_gen"><code class="docutils literal notranslate"><span class="pre">DT_logp_l_gen()</span></code></a></li>
<li><a class="reference internal" href="#stratage.age"><code class="docutils literal notranslate"><span class="pre">age()</span></code></a></li>
<li><a class="reference internal" href="#stratage.age_depth"><code class="docutils literal notranslate"><span class="pre">age_depth()</span></code></a></li>
<li><a class="reference internal" href="#stratage.fit_floating_model"><code class="docutils literal notranslate"><span class="pre">fit_floating_model()</span></code></a></li>
<li><a class="reference internal" href="#stratage.floating_age"><code class="docutils literal notranslate"><span class="pre">floating_age()</span></code></a></li>
<li><a class="reference internal" href="#stratage.geochron_height_check"><code class="docutils literal notranslate"><span class="pre">geochron_height_check()</span></code></a></li>
<li><a class="reference internal" href="#stratage.get_times"><code class="docutils literal notranslate"><span class="pre">get_times()</span></code></a></li>
<li><a class="reference internal" href="#stratage.loglike_gen"><code class="docutils literal notranslate"><span class="pre">loglike_gen()</span></code></a></li>
<li><a class="reference internal" href="#stratage.model_ls"><code class="docutils literal notranslate"><span class="pre">model_ls()</span></code></a></li>
<li><a class="reference internal" href="#stratage.randlike_gen"><code class="docutils literal notranslate"><span class="pre">randlike_gen()</span></code></a></li>
<li><a class="reference internal" href="#stratage.sigmoid"><code class="docutils literal notranslate"><span class="pre">sigmoid()</span></code></a></li>
<li><a class="reference internal" href="#stratage.trim_units"><code class="docutils literal notranslate"><span class="pre">trim_units()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=e0dbd34f"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    </body>
</html>